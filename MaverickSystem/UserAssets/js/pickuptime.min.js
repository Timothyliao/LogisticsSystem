var pickuptime = {
	init: function(a, b) {
		this.setuptime = a;
		this.run(b)
	},
	marketgetTime: function() {
		var k = this.setuptime;
		var g = new Date();
		g.setDate(g.getDate() + k);
		var h = g.getDay();
		var l = g.getHours();
		var f = parseInt(h);
		var d = "";
		var a = ["周日", "周一", "周二", "周三", "周四", "周五", "周六"];
		var e = new Array();
		var b, j;
		for (var c = k; c < 3 + k; c++) {
			if (f == 7) {
				f = 0
			}
			if (c == 0) {
				b = g.getMonth() + 1;
				j = g.getDate();
				e.push(b + "月" + j + "日 " + a[f] + " (今天)")
			} else {
				if (c == 1) {
					g.setDate(g.getDate() + 1);
					b = g.getMonth() + 1;
					j = g.getDate();
					e.push(b + "月" + j + "日 " + a[f] + " (明天)")
				} else {
					if (c == 2) {
						g.setDate(g.getDate() + 1);
						b = g.getMonth() + 1;
						j = g.getDate();
						e.push(b + "月" + j + "日 " + a[f] + " (后天)")
					} else {
						g.setDate(g.getDate() + 1);
						b = g.getMonth() + 1;
						j = g.getDate();
						e.push(b + "月" + j + "日 " + a[f])
					}
				}
			}
			f++;
			j++
		}
		e.push(l);
		return e
	},
	todoble: function(a) {
		if (a < 10) {
			a = "0" + a + ":00"
		} else {
			a = a + ":00"
		}
		return a
	},
	run: function(f) {
		var c = this.marketgetTime();
		var a = "";
		for (var b = 8; b <= 18; b++) {
			if (b <= c[3]) {
				a += "<li class='pickuptime pickuptime-sp hide'>" + this.todoble(b) + "</li>"
			} else {
				if (b == Number(c[3]) + 1) {
					a += "<li class='pickuptime pickuptime-on'>" + this.todoble(b) + "</li>"
				} else {
					a += "<li class='pickuptime'>" + this.todoble(b) + "</li>"
				}
			}
		}
		var e =
			"<div id='pickuptimeContener'>" +
			"<div class='pickuptime-close-empty'></div>" +
			"<div id='pickuptime'>" +
			"<p class='pickuptime-title'>请选择取货时间</p>" +
			"<div class='pickuptime-box'>" +
			"<div class='pickuptime-data'>" +
			"<p class='pickuptime-datap pickuptime-data-on'>" + c[0] + "</p>" +
			"<p class='pickuptime-datap'>" + c[1] + "</p>" +
			"<p class='pickuptime-datap'>" + c[2] + "</p>" +
			"</div>";
		e += "<ul>" + a + "</ul></div><div class='pickuptime-close'>关闭</div></div>";
		if ($("#pickuptimeContener").length > 0) {
			$("#pickuptimeContener").remove()
		}
		$("body").append(e);
		var d = $(window).height() - $(".pickuptime-title").offset().top;
		$(".pickuptime-close-empty").css("height", d + "px");
		$(".pickuptime-close-empty,.pickuptime-close").on("click", function() {
			$("#pickuptimeContener").remove()
		});
		$(".pickuptime-datap").on("click", function() {
			var g = $(this).index();
			if (g != 0 && $(".pickuptime-sp").hasClass('hide')) {
				$(".pickuptime-sp").removeClass('hide')
			} else {
				if (!($(".pickuptime-sp").hasClass('hide')))
					$(".pickuptime-sp").addClass('hide')
			}
			$(this).addClass("pickuptime-data-on").siblings().removeClass("pickuptime-data-on")
		});
		$(".pickuptime").on("click", function() {
			$(this).addClass("pickuptime-on").siblings().removeClass("pickuptime-on");
			var g = $(".pickuptime-data-on").text() + " " + $(".pickuptime-on").text();
			$(".pickuptime-close-empty").click();
			if (Object.prototype.toString.call(f) === "[object Function]") {
				f(g)
			} else {
				return false
			}
		})
	}
};
